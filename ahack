#!/bin/zsh

nextCmdImpl() {
  local mydir=${0:a:h}
  local aliasFileName=.alias
  local subdir=$mydir/$1
  if [[ ! -a $subdir ]] then
    subdir=$mydir/$(cat $aliasFileName | cut -d'=' -f2-)
  fi
  if [[ ! -a $subdir ]] then
    echo 'no such folder:' $subdir
    return
  fi

  local nextCmd=$subdir/ahack
  if [[ ! -a $nextCmd ]] then
    echo 'no such file:' $nextCmd
    return
  else
    shift
    $nextCmd "$@"
  fi
}

ahackImpl() {

  if (( $# == 0 )) then
    echo 'arguments needed.'
    return
  fi

  nextCmdImpl "$@"
}

ahackImpl $@
